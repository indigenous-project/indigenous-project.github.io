(this["webpackJsonpadmin-panel"]=this["webpackJsonpadmin-panel"]||[]).push([[13],{1142:function(e,t,n){"use strict";n.r(t);var r=n(58),c=n(619),a=n.n(c),i=n(620),o=n(156),s=n(1),u=n(621),p=n(641),l=n(627),d=n(624),h=n(29);t.default=function(){var e=Object(s.useState)([]),t=Object(o.a)(e,2),n=t[0],c=t[1],f=Object(s.useState)(),j=Object(o.a)(f,2),b=j[0],m=j[1],O=Object(s.useState)(!1),g=Object(o.a)(O,2),x=g[0],y=g[1],w=Object(s.useState)(!1),v=Object(o.a)(w,2),k=v[0],A=v[1],C=Object(s.useState)([]),S=Object(o.a)(C,2),E=S[0],T=S[1],N=function(){var e=Object(i.a)(a.a.mark((function e(){var t,n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(d.d)();case 2:return t=e.sent,e.next=5,t.json();case 5:n=e.sent.data,c(n);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),D=function(){var e=Object(i.a)(a.a.mark((function e(t){var r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),k.medias=[],y(!0),r=function(){var e=Object(i.a)(a.a.mark((function e(t){var r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(-1===t){e.next=7;break}return r={title:k.title,description:k.description,category:k.category?k.category:n[0]._id,isPublic:k.isPublic?k.isPublic.toString():"true"},-2!==t&&(r.medias=[t]),e.next=5,Object(p.a)(r);case 5:e.sent.ok?T([{title:"Congrats!",description:"The "+k.title+" discussion has been successfuly created",type:"success"}]):T([{title:"Error!",description:"An error occured while processing the request",type:"danger"}]);case 7:y(!1);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),!b){e.next=9;break}return e.next=7,Object(l.b)(b,T,r);case 7:e.next=10;break;case 9:r(-2);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(s.useEffect)((function(){N()}),[]),Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(u.g,{children:Object(h.jsx)(u.h,{children:Object(h.jsx)(u.U,{children:Object(h.jsxs)(u.l,{sm:"12",children:[Object(h.jsx)("h4",{id:"traffic",className:"card-title mb-0",children:"Add new discussion"}),Object(h.jsx)("div",{className:"small text-muted",children:(new Date).toDateString()})]})})})}),Object(h.jsx)(u.v,{action:"",method:"discussion",onSubmit:D,children:Object(h.jsx)(u.U,{children:Object(h.jsx)(u.l,{sm:"12",children:Object(h.jsxs)(u.g,{children:[Object(h.jsxs)(u.h,{children:[Object(h.jsxs)(u.w,{children:[Object(h.jsx)(u.K,{htmlFor:"title",children:"Discussion Title"}),Object(h.jsx)(u.E,{type:"text",id:"title",required:!0,placeholder:"Enter title...",onInput:function(e){return A(Object(r.a)(Object(r.a)({},k),{},{title:e.target.value}))},autoComplete:"name"})]}),Object(h.jsxs)(u.w,{row:!0,children:[Object(h.jsx)(u.K,{col:!0,md:"1",htmlFor:"file-input",children:"Image/Video"}),Object(h.jsx)(u.l,{xs:"12",md:"9",className:"ml-n3 mt-1",children:Object(h.jsx)(u.F,{id:"file-input",name:"file-input",onChange:function(e){return m(e.target.files[0])}})})]}),Object(h.jsx)(u.w,{row:!0,children:Object(h.jsxs)(u.l,{xs:"12",sm:"3",children:[Object(h.jsx)(u.K,{htmlFor:"select",children:"Category"}),Object(h.jsx)(u.V,{custom:!0,name:"category",id:"category",required:!0,onChange:function(e){A(Object(r.a)(Object(r.a)({},k),{},{category:e.target.value}))},children:n.filter((function(e){return"general"===e.type})).map((function(e){return Object(h.jsx)("option",{value:e._id,children:e.name},e._id)}))})]})}),Object(h.jsxs)(u.w,{row:!0,children:[Object(h.jsx)(u.l,{tag:"label",sm:"3",className:"col-form-label",children:"I want to publish this discussion:"}),Object(h.jsx)(u.l,{sm:"1",className:"ml-n5",children:Object(h.jsx)(u.gb,{onChange:function(e){return A(Object(r.a)(Object(r.a)({},k),{},{isPublic:e.target.checked}))},className:"ml-n5 mt-1",color:"info",defaultChecked:!0})})]}),Object(h.jsxs)(u.w,{children:[Object(h.jsx)(u.K,{htmlFor:"textarea-input",children:"Description"}),Object(h.jsx)(u.hb,{rows:"6",name:"description",id:"description",onInput:function(e){return A(Object(r.a)(Object(r.a)({},k),{},{description:e.target.value}))}})]})]}),Object(h.jsxs)(u.i,{className:"d-flex",children:[Object(h.jsx)(u.f,{type:"submit",size:"md",className:"btn btn-info",children:"Add Discussion"})," ",Object(h.jsx)(u.L,{size:"sm",className:"btn btn-danger ml-2",children:"Cancel"}),x?Object(h.jsx)("div",{className:"w-25",children:Object(h.jsx)(u.eb,{className:"ml-2"})}):null]})]})})})}),E.map((function(e){return Object(h.jsx)(u.lb,{position:"bottom-right",children:Object(h.jsxs)(u.ib,{show:!0,autohide:3e3,fade:!0,color:e.type,children:[Object(h.jsx)(u.kb,{closeButton:!0,children:e.title}),Object(h.jsx)(u.jb,{children:e.description})]},Math.floor(1e6*Math.random()))},"toaster"+E.id)}))]})}},624:function(e,t,n){"use strict";n.d(t,"d",(function(){return s})),n.d(t,"c",(function(){return u})),n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return p}));var r=n(619),c=n.n(r),a=n(620),i=n(622),o="Bearer "+localStorage.getItem("HDI-token"),s=function(){var e=Object(a.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(Object(i.a)("CategoriesList"),{method:"GET",mode:"cors",headers:{Authorization:o,Accept:"application/json"}}).catch((function(e){console.log(e.message)}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),u=function(){var e=Object(a.a)(c.a.mark((function e(t,n,r){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",fetch(Object(i.a)("CategoriesEdit")+"/"+t,{method:"PATCH",mode:"cors",headers:{"Content-Type":"application/json",Authorization:o,Accept:"application/json"},body:JSON.stringify(n)}).then((function(e){return e})).catch((function(e){console.log(e),r([{title:"Error!",description:"An error occured while processing the request",type:"danger"}])})));case 1:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),p=function(){var e=Object(a.a)(c.a.mark((function e(t,n){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",fetch(Object(i.a)("CategoriesDelete")+"/"+t,{method:"DELETE",mode:"cors",headers:{"Content-Type":"application/json",Authorization:o,Accept:"application/json"}}).then((function(e){return e})).catch((function(e){console.log(e),n([{title:"Error!",description:"An error occured while processing the request",type:"danger"}])})));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),l=function(){var e=Object(a.a)(c.a.mark((function e(t,n){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",fetch(Object(i.a)("CategoriesAdd"),{method:"POST",mode:"cors",headers:{"Content-Type":"application/json",Authorization:o,Accept:"application/json"},body:JSON.stringify(t)}).then((function(e){return e})).catch((function(e){console.log(e),n([{title:"Error!",description:"An error occured while processing the request",type:"danger"}])})));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},627:function(e,t,n){"use strict";n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return h}));var r=n(619),c=n.n(r),a=n(620),i=n(622),o=n(632),s="indigenous-images",u=new(n.n(o).a.S3)({accessKeyId:"AKIAWBK3UNFZVVF7OF4B",secretAccessKey:"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"}),p="Bearer "+localStorage.getItem("HDI-token"),l=function(){var e=Object(a.a)(c.a.mark((function e(t,n){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",fetch(Object(i.a)("MediasAdd"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:p,Accept:"application/json"},body:JSON.stringify(t)}).then((function(e){return e})).catch((function(e){console.log(e),n([{title:"Error!",description:"An error occured while processing the request",type:"danger"}])})));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),d=function(){var e=Object(a.a)(c.a.mark((function e(t,n,r){var i;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i={Bucket:s,Key:Math.floor(1e10*Math.random()).toString(),Body:t,ContentType:"image/jpeg",ACL:"public-read-write"},u.upload(i,function(){var e=Object(a.a)(c.a.mark((function e(a,i){var o,s;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a&&n([{title:"Error!",description:"An error occured while processing the request: "+a,type:"danger"}]),console.log("File uploaded successfully.",i),e.next=4,l({type:"image",extension:"."+t.name.split(".")[1],path:i.Location},n);case 4:if(!(o=e.sent).ok){e.next=13;break}return e.next=8,o.json();case 8:return s=e.sent,e.next=11,r(s.data._id);case 11:e.next=16;break;case 13:return e.next=15,r(-1);case 15:n([{title:"Error!",description:"An error occured while processing the request: "+a,type:"danger"}]);case 16:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),h=function(){var e=Object(a.a)(c.a.mark((function e(t,n,r){var i;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=[],t.forEach((function(e){var t={Bucket:s,Key:Math.floor(1e10*Math.random()).toString(),Body:e.content,ContentType:"image/jpeg",ACL:"public-read-write"};i.push({type:e.type,promise:u.upload(t).promise()})})),Promise.all(i.map((function(e){return e.promise}))).then(function(){var e=Object(a.a)(c.a.mark((function e(a){var i,o,s,u;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=[],o=0;case 2:if(!(o<a.length)){e.next=23;break}if(console.log("File uploaded successfully.",a[o]),"icon"===t[o].type){e.next=19;break}return e.next=7,l({type:"image",extension:".jpg",path:a[o].Location},n);case 7:if(!(s=e.sent).ok){e.next=15;break}return e.next=11,s.json();case 11:u=e.sent,i.push(u.data._id),e.next=17;break;case 15:return n([{title:"Error!",description:"An error occured while processing the request",type:"danger"}]),e.abrupt("return");case 17:e.next=20;break;case 19:i.push(a[o].Location);case 20:o++,e.next=2;break;case 23:return e.next=25,r(i);case 25:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 3:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}()},630:function(e,t){},641:function(e,t,n){"use strict";n.d(t,"c",(function(){return u})),n.d(t,"b",(function(){return p})),n.d(t,"a",(function(){return s}));var r=n(619),c=n.n(r),a=n(620),i=n(622),o="Bearer "+localStorage.getItem("HDI-token"),s=function(){var e=Object(a.a)(c.a.mark((function e(t,n){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",fetch(Object(i.a)("DiscussionsAdd"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:o,Accept:"application/json"},body:JSON.stringify(t)}).then((function(e){return e})).catch((function(e){console.log(e),n([{title:"Error!",description:"An error occured while processing the request",type:"danger"}])})));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),u=function(){var e=Object(a.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(Object(i.a)("DiscussionsList"),{method:"GET",mode:"cors",headers:{Authorization:o,Accept:"application/json"}}).catch((function(e){console.log(e.message)}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),p=function(){var e=Object(a.a)(c.a.mark((function e(t,n,r){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",fetch(Object(i.a)("DiscussionsEdit")+"/"+t,{method:"PATCH",mode:"cors",headers:{"Content-Type":"application/json",Authorization:o,Accept:"application/json"},body:JSON.stringify(n)}).then((function(e){return e})).catch((function(e){console.log(e),r([{title:"Error!",description:"An error occured while processing the request",type:"danger"}])})));case 1:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}()}}]);
//# sourceMappingURL=13.730f2546.chunk.js.map