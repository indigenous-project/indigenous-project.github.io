(this["webpackJsonpadmin-panel"]=this["webpackJsonpadmin-panel"]||[]).push([[20],{1152:function(e,t,n){"use strict";n.r(t);var c=n(58),r=n(619),s=n.n(r),i=n(620),a=n(156),l=n(1),o=n(621),d=n(640),u=n(628),j=n.n(u),b=n(623),h=n(1133),p=n(29),O=function(e){var t=e.poll,n=e.setPoll,r=e.setToastMessage,u=(e.toastMessages,e.loadPollsList),j=Object(l.useState)(!1),b=Object(a.a)(j,2),h=b[0],O=b[1],x=function(){var e=Object(i.a)(s.a.mark((function e(n){var c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),O(!0),c={title:t.title,link:t.link,startDate:t.startDate,endDate:t.endDate,isPublic:t.isPublic.toString()},e.next=5,Object(d.b)(t._id,c,r);case 5:e.sent.ok?(u(),r([{title:"Congrats!",description:"The information of poll with id: "+t._id+" has been successfuly changed",type:"success"}])):r([{title:"Error!",description:"An error occured while processing the request",type:"danger"}]),O(!1);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(o.g,{children:Object(p.jsx)(o.h,{children:Object(p.jsx)(o.U,{children:Object(p.jsxs)(o.l,{sm:"12",children:[Object(p.jsx)("h4",{id:"traffic",className:"card-title mb-0",children:"ID: "+t._id}),Object(p.jsx)("div",{className:"small text-muted",children:(new Date).toDateString()})]})})})}),Object(p.jsx)(o.v,{action:"",method:"poll",onSubmit:x,children:Object(p.jsx)(o.U,{children:Object(p.jsx)(o.l,{sm:"12",children:Object(p.jsxs)(o.g,{children:[Object(p.jsxs)(o.h,{children:[Object(p.jsxs)(o.w,{children:[Object(p.jsx)(o.K,{htmlFor:"name",children:"Poll Title"}),Object(p.jsx)(o.E,{type:"text",id:"name",required:!0,placeholder:"Enter Name...",onInput:function(e){return n(Object(c.a)(Object(c.a)({},t),{},{title:e.target.value}))},autoComplete:"title",value:t.title})]}),Object(p.jsxs)(o.w,{children:[Object(p.jsx)(o.K,{htmlFor:"link",children:"Poll Link"}),Object(p.jsx)(o.E,{type:"text",id:"link",required:!0,placeholder:"Enter Link...",onInput:function(e){return n(Object(c.a)(Object(c.a)({},t),{},{link:e.target.value}))},autoComplete:"link",value:t.link})]}),Object(p.jsxs)(o.w,{row:!0,children:[Object(p.jsxs)(o.l,{sm:"6",children:[Object(p.jsx)(o.K,{htmlFor:"startDate",children:"Start Date"}),Object(p.jsx)(o.E,{type:"date",min:(new Date).toISOString().split("T")[0],id:"startDate",required:!0,placeholder:"Enter start date...",onChange:function(e){return n(Object(c.a)(Object(c.a)({},t),{},{startDate:e.target.value}))},value:t.startDate.split("T")[0]})]}),Object(p.jsxs)(o.l,{sm:"6",children:[Object(p.jsx)(o.K,{htmlFor:"endDate",children:"End Date"}),Object(p.jsx)(o.E,{type:"date",min:(new Date).toISOString().split("T")[0],id:"endDate",required:!0,placeholder:"Enter end date...",onChange:function(e){return n(Object(c.a)(Object(c.a)({},t),{},{endDate:e.target.value}))},value:t.endDate.split("T")[0]})]})]}),Object(p.jsxs)(o.w,{row:!0,children:[Object(p.jsx)(o.l,{tag:"label",sm:"3",className:"col-form-label",children:"I want to publish this poll:"}),Object(p.jsx)(o.l,{sm:"1",className:"ml-n5",children:Object(p.jsx)(o.gb,{onChange:function(e){return n(Object(c.a)(Object(c.a)({},t),{},{isPublic:e.target.checked}))},className:"ml-n5 mt-1",color:"info",checked:!!t.isPublic})})]})]}),Object(p.jsxs)(o.i,{className:"d-flex",children:[Object(p.jsx)(o.f,{type:"submit",size:"md",className:"btn btn-info",children:"Edit Poll"})," ",Object(p.jsx)(o.L,{size:"sm",className:"btn btn-danger ml-2",children:"Cancel"}),h?Object(p.jsx)("div",{className:"w-25",children:Object(p.jsx)(o.eb,{className:"ml-2"})}):null]})]})})})})]})},x=function(e){var t=e.poll;return console.log("poll: ",t),Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(o.g,{children:Object(p.jsx)(o.h,{children:Object(p.jsx)(o.U,{children:Object(p.jsxs)(o.l,{sm:"12",children:[Object(p.jsxs)("h4",{id:"traffic",className:"card-title mb-0",children:["ID: ",t._id]}),Object(p.jsx)("div",{className:"small text-muted",children:(new Date).toDateString()})]})})})}),t?Object(p.jsxs)(o.U,{className:"pb-4",children:[Object(p.jsx)(o.l,{sm:"6",children:Object(p.jsxs)(o.M,{children:[Object(p.jsxs)(o.N,{children:[Object(p.jsx)("strong",{children:"Title: "}),t.title]}),Object(p.jsxs)(o.N,{children:[Object(p.jsx)("strong",{children:"Start Date: "}),t.startDate?t.startDate.replace("T"," ").replace("Z","").substring(0,16):""]}),Object(p.jsxs)(o.N,{children:[Object(p.jsx)("strong",{children:"End Date: "}),t.endDate?t.endDate.replace("T"," ").replace("Z","").substring(0,16):""]})]})}),Object(p.jsx)(o.l,{sm:"6",children:Object(p.jsxs)(o.M,{children:[Object(p.jsxs)(o.N,{children:[Object(p.jsx)("strong",{children:"Link: "}),Object(p.jsx)(o.L,{target:"_blank",href:t.link,children:t.link})]}),Object(p.jsxs)(o.N,{children:[Object(p.jsx)("strong",{children:"Created At: "}),t.createdAt?t.createdAt.replace("T"," ").replace("Z","").substring(0,16):""]}),Object(p.jsxs)(o.N,{children:[Object(p.jsx)("strong",{children:"Last Update At: "}),t.updatedAt?t.updatedAt.replace("T"," ").replace("Z","").substring(0,16):""]})]})})]}):null]})},f=function(e){return Object(p.jsx)(b.a,{content:h.a[e]})};t.default=function(){var e=Object(l.useState)([]),t=Object(a.a)(e,2),n=t[0],r=t[1],u=Object(l.useState)({show:!1}),b=Object(a.a)(u,2),h=b[0],g=b[1],m=Object(l.useState)([]),y=Object(a.a)(m,2),w=y[0],v=y[1],k=Object(l.useState)(""),D=Object(a.a)(k,2),P=D[0],N=D[1],C=Object(l.useState)(!0),T=Object(a.a)(C,2),S=T[0],A=T[1],E=Object(l.useState)([]),L=Object(a.a)(E,2),I=L[0],M=L[1],q=function(){var e=Object(i.a)(s.a.mark((function e(){var t,n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return A(!0),e.next=3,Object(d.c)();case 3:return t=e.sent,e.next=6,t.json();case 6:n=e.sent.data,console.log(n),r(n),U(P,n),A(!1);case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),U=function(e,t){e=e.toLowerCase();var c=(t||n).filter((function(t){return t.title.toLowerCase().includes(e)||t.startDate.toLowerCase().includes(e)||t.endDate.toLowerCase().includes(e)})).sort((function(e,t){return e.createdAt-t.createdAt})).reverse();v(c),N(e)},_=function(){var e=Object(i.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(d.b)(t,{isDeleted:"true"},M);case 2:if(!(n=e.sent).ok){e.next=9;break}return M([{title:"Congrats!",description:"The Poll with id: "+t+" has been successfuly deleted",type:"success"}]),e.next=7,q();case 7:e.next=10;break;case 9:M([{title:"Error!",description:"An error occured while processing the request",type:"danger"}]);case 10:console.log(n),g({show:!1,type:"delete"});case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),F=function(){var e=Object(i.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(d.b)(t,{isPublic:!h.isPublic+""},M);case 2:if(n=e.sent,g({show:!1,type:"isPublic"}),!n.ok){e.next=10;break}return M([{title:"Congrats!",description:"The publicity status of Poll with id: "+t+" has been successfuly changed",type:"success"}]),e.next=8,q();case 8:e.next=11;break;case 10:M([{title:"Error!",description:"An error occured while processing the request",type:"danger"}]);case 11:console.log(n);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();Object(l.useEffect)((function(){q()}),[]);var z=[{name:Object(p.jsx)("strong",{children:"Title"}),selector:"title",sortable:!0,left:!0},{name:Object(p.jsx)("strong",{children:"Start date"}),selector:"subTitle",sortable:!0,left:!0,cell:function(e){return new Date(e.startDate).toLocaleDateString()}},{name:Object(p.jsx)("strong",{children:"End date"}),selector:"type",sortable:!0,left:!0,cell:function(e){return new Date(e.endDate).toLocaleDateString()}},{name:Object(p.jsx)("strong",{children:"Is Visible"}),selector:"isPublic",sortable:!0,center:!0,cell:function(e){return Object(p.jsx)(o.b,{color:e.isPublic?"success":"danger",className:"float-right",children:e.isPublic?"Yes":"No"})}},{name:"",selector:"_id",cell:function(e){return Object(p.jsxs)("div",{children:[Object(p.jsx)(o.L,{className:"card-header-action",onClick:function(){return g(Object(c.a)(Object(c.a)({},e),{},{jobType:e.type,show:!h.show,type:"detail"}))},children:f("cilInfo")}),Object(p.jsx)(o.L,{className:"card-header-action",onClick:function(){return g(Object(c.a)(Object(c.a)({},e),{},{pollType:e.type,show:!h.show,type:"edit"}))},children:f("cilPencil")}),Object(p.jsx)(o.L,{className:"card-header-action",onClick:function(){return g({id:e._id,title:e.title,isPublic:e.isPublic,show:!h.show,type:"isPublic"})},children:f("cilCloudUpload")}),Object(p.jsx)(o.L,{className:"card-header-action",onClick:function(){return g({id:e._id,title:e.title,show:!h.show,type:"delete"})},children:f("cilTrash")})]})}}];return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(o.g,{children:Object(p.jsxs)(o.h,{children:[Object(p.jsx)(o.U,{children:Object(p.jsx)(o.l,{sm:"6"})}),Object(p.jsx)(o.U,{children:Object(p.jsxs)(o.l,{sm:"12",children:[Object(p.jsx)(o.E,{type:"text",id:"searchText",placeholder:"search by keyword ...",onInput:function(e){return U(e.target.value)}}),Object(p.jsx)(j.a,{title:"Polls List",columns:z,data:w,highlightOnHover:!0,pagination:!0,progressPending:S})]})})]})}),Object(p.jsxs)(o.O,{show:h.show,onClosed:function(){g({show:!1,type:h.type}),M([])},color:"delete"===h.type?"danger":"isPublic"===h.type?"warning":"info",size:"edit"===h.type||"detail"===h.type?"xl":"",children:[Object(p.jsx)(o.R,{closeButton:!0,children:Object(p.jsx)(o.S,{children:"delete"===h.type?"Delete Poll account":"edit"===h.type?"Edit Poll profile":"detail"===h.type?"Poll detail":"Change Publicity status"})}),h.show?Object(p.jsxs)(o.P,{children:["delete"===h.type?Object(p.jsxs)("div",{children:["Are you sure you want to delete ",Object(p.jsx)("strong",{children:h.title}),"?"]}):"isPublic"===h.type?Object(p.jsxs)("div",{children:["Are you sure you want to change publicity status of ",Object(p.jsx)("strong",{children:h.title}),"?"]}):null,"edit"===h.type?Object(p.jsx)(O,{loadPollsList:q,poll:h,setPoll:g,setToastMessage:M,toastMessages:I}):"detail"===h.type?Object(p.jsx)(x,{poll:h}):null]}):null,"delete"===h.type||"isPublic"===h.type?Object(p.jsxs)(o.Q,{children:[Object(p.jsx)(o.f,{color:"delete"===h.type?"danger":"warning",onClick:function(){return"delete"===h.type?_(h.id):F(h.id)},children:"Yes"}),Object(p.jsx)(o.f,{color:"secondary",onClick:function(){return g({show:!1})},children:"Cancel"})]}):null]}),I.map((function(e){return console.log(e),Object(p.jsx)(o.lb,{position:"bottom-right",children:Object(p.jsxs)(o.ib,{show:!0,autohide:3e3,fade:!0,color:e.type,children:[Object(p.jsx)(o.kb,{closeButton:!0,children:e.title}),Object(p.jsx)(o.jb,{children:e.description})]},Math.floor(1e6*Math.random()))},"toaster"+Math.floor(1e6*Math.random()))}))]})}},640:function(e,t,n){"use strict";n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return l}));var c=n(619),r=n.n(c),s=n(620),i=n(622),a="Bearer "+localStorage.getItem("HDI-token"),l=function(){var e=Object(s.a)(r.a.mark((function e(t,n){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",fetch(Object(i.a)("PollsAdd"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:a,Accept:"application/json"},body:JSON.stringify(t)}).then((function(e){return e})).catch((function(e){console.log(e),n([{title:"Error!",description:"An error occured while processing the request",type:"danger"}])})));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),o=function(){var e=Object(s.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(Object(i.a)("PollsList"),{method:"GET",mode:"cors",headers:{Authorization:a,Accept:"application/json"}}).catch((function(e){console.log(e.message)}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),d=function(){var e=Object(s.a)(r.a.mark((function e(t,n,c){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",fetch(Object(i.a)("PollsEdit")+"/"+t,{method:"PATCH",mode:"cors",headers:{"Content-Type":"application/json",Authorization:a,Accept:"application/json"},body:JSON.stringify(n)}).then((function(e){return e})).catch((function(e){console.log(e),c([{title:"Error!",description:"An error occured while processing the request",type:"danger"}])})));case 1:case"end":return e.stop()}}),e)})));return function(t,n,c){return e.apply(this,arguments)}}()}}]);
//# sourceMappingURL=20.68a63065.chunk.js.map